<div class="noprint" id="pagepath" style="background-color: white; float: left; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 10px; padding: 0.4em 0px;">
<h1 style="break-after: avoid; display: inline; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 19px; letter-spacing: -0.018em; margin: 0.15em 1em 0.5em 0px;">
<a class="pathentry first" href="https://trac.ffmpeg.org/wiki" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #999988; float: left; margin: 0px 0.2em; text-decoration-line: none;" title="View WikiStart">wiki:</a></h1>
<h1 style="break-after: avoid; color: #bb0000; display: inline; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 19px; letter-spacing: -0.018em; margin: 0.15em 1em 0.5em 0px;">
<a class="pathentry" href="https://trac.ffmpeg.org/wiki/Capture" style="border-bottom: 1px dotted rgb(187, 187, 187); float: left; margin: 0px 0.2em; text-decoration-line: none;" title="View Capture">Capture</a></h1>
<span class="pathentry sep" style="color: #666666; float: left; padding: 0px 0.1em;">/</span><h1 style="break-after: avoid; color: #bb0000; display: inline; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 19px; letter-spacing: -0.018em; margin: 0.15em 1em 0.5em 0px;">
<a class="pathentry" href="https://trac.ffmpeg.org/wiki/Capture/Capture" style="border-bottom: 1px dotted rgb(187, 187, 187); float: left; margin: 0px 0.2em; text-decoration-line: none;" title="View Capture/Capture">Capture</a></h1>
<span class="pathentry sep" style="color: #666666; float: left; padding: 0px 0.1em;">/</span><h1 style="break-after: avoid; color: #bb0000; display: inline; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 19px; letter-spacing: -0.018em; margin: 0.15em 1em 0.5em 0px;">
<a class="pathentry" href="https://trac.ffmpeg.org/wiki/Capture/Capture/Desktop%E4%B8%AD%E6%96%87%E7%89%88%E6%9C%AC" style="border-bottom: 1px dotted rgb(187, 187, 187); float: left; margin: 0px 0.2em; text-decoration-line: none;" title="View Capture/Capture/Desktop中文版本">Desktop中文版本</a></h1>
</div>
<div class="nav" id="ctxtnav" style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px; min-height: 1em; padding: 0.4em 0px;">
<ul style="font-size: 10px; list-style: none; margin: 0px; padding: 0px; text-align: right;">
<li class="first" style="border-right: 1px solid rgb(215, 215, 215); display: inline-block; padding: 0px 0.75em; white-space: nowrap; zoom: 1;"><span id="vote" title="Vote count"><img alt="Up-vote" src="https://trac.ffmpeg.org/chrome/vote/aupgray.png" style="border: none; vertical-align: middle;" /><span id="votes" style="font-weight: bold;">+0</span><img alt="Down-vote" src="https://trac.ffmpeg.org/chrome/vote/adowngray.png" style="border: none; vertical-align: middle;" /></span></li>
<li style="border-right: 1px solid rgb(215, 215, 215); display: inline-block; padding: 0px 0.75em; white-space: nowrap; zoom: 1;"><a href="https://trac.ffmpeg.org/wiki/Capture/Capture" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Up</a></li>
<li style="border-right: 1px solid rgb(215, 215, 215); display: inline-block; padding: 0px 0.75em; white-space: nowrap; zoom: 1;"><a href="https://trac.ffmpeg.org/wiki/WikiStart" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Start Page</a></li>
<li style="border-right: 1px solid rgb(215, 215, 215); display: inline-block; padding: 0px 0.75em; white-space: nowrap; zoom: 1;"><a href="https://trac.ffmpeg.org/wiki/TitleIndex" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Index</a></li>
<li class="last" style="border-right: none; display: inline-block; padding: 0px 0.75em; white-space: nowrap; zoom: 1;"><a href="https://trac.ffmpeg.org/wiki/Capture/Capture/Desktop%E4%B8%AD%E6%96%87%E7%89%88%E6%9C%AC?action=history" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">History</a></li>
</ul>
</div>
<div class="wiki" id="content" style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px; position: relative;">
<div class="wikipage searchable" style="padding-left: 18px;">
<div class="trac-content" id="wikipage" style="border-radius: 0.5em; border: 1px solid rgb(228, 228, 228); box-shadow: rgb(238, 238, 238) 0.2em 0.3em 1.5em; clear: both; margin: 0.3em auto 0.3em -18px; padding: 0.5em 1em 0.5em 28px;">
<h2 id="Linux系统" style="border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
Linux 系统<a class="anchor" href="https://trac.ffmpeg.org/wiki/Capture/Capture/Desktop%E4%B8%AD%E6%96%87%E7%89%88%E6%9C%AC#Linux%E7%B3%BB%E7%BB%9F" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
使用&nbsp;<a href="https://ffmpeg.org/ffmpeg-devices.html#x11grab" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">x11grab</a>&nbsp;设备采集视频图像:<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :0.0+100,200 output.mp4
</pre>
这条命令将会从桌面图像的左上角偏移坐标位置为 (x=100, y=200)处获取宽高为1024x768的图像, .<br />
如果需要加入音频，则采集&nbsp;<a href="https://ffmpeg.org/ffmpeg-devices.html#alsa-1" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">ALSA</a>&nbsp;(参考&nbsp;<a class="wiki" href="https://trac.ffmpeg.org/wiki/Capture/ALSA" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Capture/ALSA</a>&nbsp;获得更多信息):<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :0.0+100,200 -f alsa -ac 2 -i hw:0 output.mkv
</pre>
或者采集&nbsp;<a href="https://ffmpeg.org/ffmpeg-devices.html#pulse" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">pulse</a>&nbsp;输入设备:<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :0.0+100,200 -f pulse -ac 2 -i default output.mkv
</pre>
<h2 id="苹果OSX系统" style="border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
苹果 OS X 系统<a class="anchor" href="https://trac.ffmpeg.org/wiki/Capture/Capture/Desktop%E4%B8%AD%E6%96%87%E7%89%88%E6%9C%AC#%E8%8B%B9%E6%9E%9COSX%E7%B3%BB%E7%BB%9F" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
使用&nbsp;<a href="https://ffmpeg.org/ffmpeg-devices.html#avfoundation" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">avfoundation</a>&nbsp;设备采集音视频:<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -f avfoundation -list_devices true -i ""
</pre>
这条命令执行后将列出所有 avfoundation 的音频、视频采集设备列表。 可以通过指定想要采集的设备名采集音频、视频:<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -f avfoundation -i "&lt;screen device index&gt;:&lt;audio device index&gt;" out.mov
</pre>
这条命令执行后将会从&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">&lt;screen device index&gt;</tt>&nbsp;编号处获得视频图像，从&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">&lt;audio device index&gt;</tt>&nbsp;编号处获得音频数据写入至输出文件&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">out.mov</tt>&nbsp;中.<br />
<h2 id="Windows系统" style="border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
Windows 系统<a class="anchor" href="https://trac.ffmpeg.org/wiki/Capture/Capture/Desktop%E4%B8%AD%E6%96%87%E7%89%88%E6%9C%AC#Windows%E7%B3%BB%E7%BB%9F" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
使用&nbsp;<a class="wiki" href="https://trac.ffmpeg.org/wiki/DirectShow" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">DirectShow</a>&nbsp;<a class="ext-link" href="https://github.com/rdp/screen-capture-recorder-to-video-windows-free" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../extlink.gif&quot;) left center no-repeat; padding-left: 15px;">​</span>device</a>设备采集音视频数据:<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -f dshow -i video="screen-capture-recorder" output.flv
</pre>
执行这条命令后将会 从DirectShow 设备中获得桌面图像并输出为output。flv文件. 可以参考&nbsp;<a class="ext-link" href="http://betterlogic.com/roger/2010/07/list-of-available-directshow-screen-capture-filters/" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../extlink.gif&quot;) left center no-repeat; padding-left: 15px;">​</span>list of alternative devices</a>.<br />
如果需要采集视频外还需要采集音频则使用如下命令:<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -f dshow -i video="UScreenCapture":audio="Microphone" output.flv
</pre>
如果你想获得正在从扬声器播放的音频，需要配置 “Stereo Mix” 设备<br />
或者<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -f dshow -i video="UScreenCapture" -f dshow -i audio="Microphone" output.flv
</pre>
可以通过如下命令行列出所有dshow设备:<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -list_devices true -f dshow -i dummy
</pre>
同样可以使用&nbsp;<a href="https://ffmpeg.org/ffmpeg-devices.html#gdigrab" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">gdigrab</a>&nbsp;输入设备从Widnows系统桌面获得屏幕图像.<br />
<h2 id="注意事项" style="border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
注意事项<a class="anchor" href="https://trac.ffmpeg.org/wiki/Capture/Capture/Desktop%E4%B8%AD%E6%96%87%E7%89%88%E6%9C%AC#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
如果你的配置比较低, 使用下面的命令可能会提高你的音视频编码效率，但是质量会稍微有些降低. 在这种情况下,首先你需要获取并将获取的图像保存为未压缩的视频/音频，并且当你完成抓取过程然后开始将它转换为任何你所需要的编码:<br />
Linux:<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -framerate 25 -video_size 1024x768 -f x11grab -i :0.0+100,200 -f alsa -ac 2 -i pulse -vcodec libx264 -crf 0 -preset ultrafast -acodec pcm_s16le output.mkv
ffmpeg -i output.mkv -acodec ... -vcodec ... final.mkv
</pre>
Windows:<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -f dshow -i video="screen-capture-recorder":audio="Microphone" -vcodec libx264 -crf 0 -preset ultrafast -acodec pcm_s16le output.mkv
ffmpeg -i output.flv -acodec ... -vcodec ... final.mkv
</pre>
<h2 id="无损录制" style="border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
无损录制<a class="anchor" href="https://trac.ffmpeg.org/wiki/Capture/Capture/Desktop%E4%B8%AD%E6%96%87%E7%89%88%E6%9C%AC#%E6%97%A0%E6%8D%9F%E5%BD%95%E5%88%B6" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
如果你想很好的将桌面图像录制下来，x264编码器可以做到，使用无损编码方式即可，例如：<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -video_size 1920x1080 -framerate 30 -f x11grab -i :0.0 -c:v libx264 -qp 0 -preset ultrafast capture.mkv
</pre>
<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">-qp 0</tt>&nbsp;这个参数是设置 x264 的压缩参数为无损压缩,&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">-preset ultrafast</tt>&nbsp;预设值参数将会尽快的进行 x264 编码压缩.<br />
这么做在当前主流的硬件设备上做不丢帧的编码是可以做到足够快的，并且还不会占用全部的CPU。<br />
可以通过一次录制，一次编码的方式进行无损编码压缩，录制的时候以最快速度将视频图像录制下来，然后对录制下来的图像进行慢速压缩，这样可以保证图像质量，并且可以保证视频不丢帧<br />
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -i capture.mkv -c:v libx264 -qp 0 -preset veryslow capture_smaller.mkv
</pre>
参考&nbsp;<a class="wiki" href="https://trac.ffmpeg.org/wiki/Encode/H.264" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Encode/H.264</a>&nbsp;获得更多信息和例子.</div>
</div>
</div>


<h1 id="DirectShow" style="background-color: white; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 19px; letter-spacing: -0.018em; margin: 0.15em 1em 0.5em -18px;">
DirectShow<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#DirectShow" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h1>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
</div>
<div class="wiki-toc" style="background: rgb(255, 255, 221); border: 1px outset rgb(221, 221, 204); clear: right; float: right; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 12px; margin: 0px 0px 2em 1em; padding: 0.5em 1em; position: relative;">
<h4 style="break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; letter-spacing: -0.018em; margin: 0px;">
Contents</h4>
<ol style="list-style: none; margin: 0px; padding: 0px;">
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#DirectShow" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">DirectShow</a><ol style="list-style: none; margin: 0px; padding: 0px 1.2em;">
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#a" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"></a><ol style="list-style: none; margin: 0px; padding: 0px 1.2em;">
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#Specifyinginputframerate" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Specifying input framerate</a></li>
</ol>
</li>
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#BufferingLatency" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Buffering/Latency</a></li>
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#UsingDirectShowwithlibav" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Using DirectShow with libav*</a></li>
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#Howtoprogrammaticallyenumeratedevices" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">How to programmatically enumerate devices</a></li>
</ol>
</li>
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#Related" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Related</a><ol style="list-style: none; margin: 0px; padding: 0px 1.2em;">
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#screencapture" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">screen capture</a></li>
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#AviSynthInput" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">AviSynth Input</a></li>
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#Runningffmpeg.exewithoutopeningaconsolewindow" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Running&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">ffmpeg.exe</tt>&nbsp;without opening a console window</a></li>
</ol>
</li>
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#ffdshowtryouts" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">ffdshow tryouts</a></li>
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#Support" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Support</a><ol style="list-style: none; margin: 0px; padding: 0px 1.2em;">
<li style="margin: 0px; padding: 0px;"><a href="https://trac.ffmpeg.org/wiki/DirectShow#KnownBugsFeatureRequests" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Known Bugs/Feature Requests</a></li>
</ol>
</li>
</ol>
</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
FFmpeg can take input from "directshow" devices on your Windows computer. See the&nbsp;<a class="ext-link" href="http://ffmpeg.org/ffmpeg-devices.html#dshow" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../extlink.gif&quot;) left center no-repeat; padding-left: 15px;">​</span>FFmpeg dshow input device documentation</a>&nbsp;for official documentation. It can accept input from audio, video devices, video capture devices, analog tv tuner devices.</div>
<h2 id="a" style="background-color: white; border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#a" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
Example to list dshow input devices:</div>
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; font-size: 13px; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">c:\&gt; ffmpeg -list_devices true -f dshow -i dummy
ffmpeg version N-45279-g6b86dd5... --enable-runtime-cpudetect
  libavutil      51. 74.100 / 51. 74.100
  libavcodec     54. 65.100 / 54. 65.100
  libavformat    54. 31.100 / 54. 31.100
  libavdevice    54.  3.100 / 54.  3.100
  libavfilter     3. 19.102 /  3. 19.102
  libswscale      2.  1.101 /  2.  1.101
  libswresample   0. 16.100 /  0. 16.100
[dshow @ 03ACF580] DirectShow video devices
[dshow @ 03ACF580]  "Integrated Camera"
[dshow @ 03ACF580]  "screen-capture-recorder"
[dshow @ 03ACF580] DirectShow audio devices
[dshow @ 03ACF580]  "Internal Microphone (Conexant 2"
[dshow @ 03ACF580]  "virtual-audio-capturer"
dummy: Immediate exit requested
</pre>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
Example to use a dshow device as an input:</div>
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; font-size: 13px; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">c:\&gt; ffmpeg -f dshow -i video="Integrated Camera" out.mp4
</pre>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
Note: "Integrate Camera" is the device name used as an input to dshow and it may differ on other hardware. Tou must always use the device name listed on your hardware. Screen capture recorder is a third party downloadable dshow capture source, here as an example.</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
Example to use audio and video dshow device as an input:</div>
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; font-size: 13px; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">c:\&gt; ffmpeg -f dshow -i video="Integrated Camera":audio="Microphone name here" out.mp4
</pre>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
You can also pass the device certain parameters that it needs, for instance a webcam might allow you to capture it in 1024x768 at up to max 5 fps, or allow you to capture at 640x480 at 30 fps.</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
Example to print a list of options from a selected device:</div>
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; font-size: 13px; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">c:\&gt; ffmpeg -f dshow -list_options true -i video="Integrated Camera"
ffmpeg version N-45279-g6b86dd5 Copyright (c) 2000-2012 the FFmpeg developers
  built on Oct 10 2012 17:30:47 with gcc 4.7.1 (GCC)
  configuration:...
  libavutil      51. 74.100 / 51. 74.100
  libavcodec     54. 65.100 / 54. 65.100
  libavformat    54. 31.100 / 54. 31.100
  libavdevice    54.  3.100 / 54.  3.100
  libavfilter     3. 19.102 /  3. 19.102
  libswscale      2.  1.101 /  2.  1.101
  libswresample   0. 16.100 /  0. 16.100
[dshow @ 01D4F3E0] DirectShow video device options
[dshow @ 01D4F3E0]  Pin "Capture"
[dshow @ 01D4F3E0]   pixel_format=yuyv422  min s=640x480 fps=15 max s=640x480 fps=30
[dshow @ 01D4F3E0]   pixel_format=yuyv422  min s=1280x720 fps=7.5 max s=1280x720 fps=7.5
[dshow @ 01D4F3E0]   vcodec=mjpeg  min s=640x480 fps=15 max s=640x480 fps=30
[dshow @ 01D4F3E0]   vcodec=mjpeg  min s=1280x720 fps=15 max s=1280x720 fps=30
video=Integrated Camera: Immediate exit requested
</pre>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
You can see in this particular instance that it can either stream it to you in a "raw pixel_format" (yuyv422 in this case), or as an mjpeg stream.</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">ffmpeg -f dshow -video_size 1280x720 -framerate 7.5 -pixel_format yuyv422 -i video="Integrated Camera" out.avi</tt></div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
You can specify the type (mjpeg) and size (1280x720) and frame rate to tell the device to give you (15 fps) (note for instance, in this instance, the camera can give you a higher frame rate/size total if you specify mjpeg):</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">ffmpeg -f dshow -video_size 1280x720 -framerate 15 -vcodec mjpeg -i video="Integrated Camera" out.avi</tt></div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
You can specify "-vcodec copy" to&nbsp;<a class="ext-link" href="http://ffmpeg.org/ffmpeg.html#Stream-copy" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../extlink.gif&quot;) left center no-repeat; padding-left: 15px;">​</span>stream copy</a>&nbsp;the video instead of re-encoding, if you can receive the data in some type of pre-encoded format, like mjpeg in this instance.</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
Example audio list options:</div>
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; font-size: 13px; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">c:\&gt; ffmpeg -f dshow -list_options true -i audio=virtual-audio-capturer
ffmpeg version N-50911-g9efcfbe Copyright (c) 2000-2013 the FFmpeg developers
  built on Mar 13 2013 21:26:48 with gcc 4.7.2 (GCC)
  configuration:...
  libavutil      52. 19.100 / 52. 19.100
  libavcodec     55.  0.100 / 55.  0.100
  libavformat    55.  0.100 / 55.  0.100
  libavdevice    54.  4.100 / 54.  4.100
  libavfilter     3. 45.103 /  3. 45.103
  libswscale      2.  2.100 /  2.  2.100
  libswresample   0. 17.102 /  0. 17.102
  libpostproc    52.  2.100 / 52.  2.100
[dshow @ 0215bc00] DirectShow audio device options
[dshow @ 0215bc00]  Pin "Capture Pin"
[dshow @ 0215bc00]   min ch=2 bits=16 rate= 44100 max ch=2 bits=16 rate= 44100
audio=virtual-audio-capturer: Immediate exit requested
</pre>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
Also this note&nbsp;<a class="ext-link" href="http://ffmpeg.zeranoe.com/forum/viewtopic.php?f=3&amp;t=27" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../extlink.gif&quot;) left center no-repeat; padding-left: 15px;">​</span>that</a>&nbsp;the input string is in the format video=&lt;video device name&gt;:audio=&lt;audio device name&gt;. It is possible to have two separate inputs (like -f dshow -i audio=foo -f dshow -i video=bar) though some limited tests had shown a difference in synchronism between the two options at times. Possibly you can overcome it using the "-copy_ts" flag. The reason this works is that each "input" is assumed to start "at its first input time" and FFmpeg, by default, basically normalizes it "from its first input" as meaning "0.0 seconds." Because ffmpeg is using two different dshow inputs, it basically starts one up, then starts up the second *after* so it might start sending in packets a fraction of a second later, and FFmpeg happily treats its "later starting" timestamps as also 0.0 so mixing them doesn't work well if they start off set. So if you use -copy_ts then it will start them with "relative to machine start time" timestamps which should be able to mix accurately in theory. Ping me if you want it fixed to come more than one audio and one video in an input and thus not need these work arounds&nbsp;<a class="mail-link" href="mailto:rogerdpack@gmail.com" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../envelope.png&quot;) left center no-repeat; padding-left: 16px;">​</span>rogerdpack@gmail.com</a></div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
Also note that you can only at most have 2 streams at once (one audio and one video, like -i video=XX:audio=YY). Ask if you want this improved. You can have multiples one after the other, however, like</div>
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; font-size: 13px; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffmpeg -f dshow -i video=XX:audio=ZZ -f dshow -i video=ZZ:audio=QQ
</pre>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
FFmpeg can also "merge/combine" multiple audio inputs, like the above using its amix filter (it can also combine video inputs of course, or record them as separate streams).</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
See the&nbsp;<a class="ext-link" href="http://ffmpeg.org/ffmpeg-devices.html#dshow" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../extlink.gif&quot;) left center no-repeat; padding-left: 15px;">​</span>FFmpeg dshow input device documentation</a>&nbsp;for a list of more dshow options you can specify. For instance you can decrease latency on audio devices, or specify a video by "index" if two have the same name, etc. etc.</div>
<h3 id="Specifyinginputframerate" style="background-color: white; border-bottom: 1px dashed rgb(221, 221, 221); break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 14px; letter-spacing: -0.018em; margin-left: -18px;">
Specifying input framerate<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#Specifyinginputframerate" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h3>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
You can set framerate like&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">ffmpeg -f dshow -framerate 7.5 -i video=XXX</tt>. This instructs the device itself to send you frames at 7.5 fps [if it can].</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
Be careful *not* to specify framerate with the "-r" parameter, like this&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">ffmpeg -f dshow -r 7.5 -i video=XXX</tt>. This actually specifies that the devices incoming PTS timestamps be *ignored* and replaced as if the device were running at 7.5 fps [so it runs at default fps, but its timestamps are treated as if 7.t fps]. This can cause the recording to appear to have "video slower than audio" or, under high cpu load (if video frames are dropped) it will cause the video to fall "behind" the audio [after playback of the recording is done, audio continues on--and gets highly out of sync, video appears to go into "fast forward" mode during high cpu scenes].</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
If you want say 10 fps, and you device only supports 7.5 and 15 fps, then run it at fps then "downsample" to 10 fps. There are a few ways to do this--you could specify your output to be 10 fps, like this:&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">ffmpeg -f dshow -framerate 15 -i video=XXX -r 10 output.mp4</tt>&nbsp;or insert a filter to do the same thing for you:&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">ffmpeg -f dshow -framerate 15 -vf fps=15 output.mp4</tt>.</div>
<h2 id="BufferingLatency" style="background-color: white; border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
Buffering/Latency<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#BufferingLatency" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
By default FFmpeg captures frames from the input, and then does whatever you told it to do, for instance, re-encoding them and saving them to an output file. By default if it receives a video frame "too early" (while the previous frame isn't finished yet), it will discard that frame, so that it can keep up the the real time input. You can adjust this by setting the&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">-rtbufsize</tt>&nbsp;parameter, though note that if your encoding process can't keep up, eventually you'll still start losing frames just the same (and using it at all can introduce a bit of latency). It may be helpful to still specify some size of buffer, however, otherwise frames may be needlessly dropped possibly.</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
See&nbsp;<a class="wiki" href="https://trac.ffmpeg.org/wiki/StreamingGuide" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">StreamingGuide</a>&nbsp;for some tips on tweaking encoding (sections latency and cpu usage). For instance, you could save it to a very fast codec, then re-encode it later.</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
There is also an option audio_buffer_size. Basically if you're capturing from a live mic, the default behavior for this hardware device is to "buffer" 500ms (or 1000ms) worth of data, before it starts sending it down the pipeline. This can introduce startup latency, so setting this to 50ms (msdn suggests 80ms) may be a better idea here. The timestamps on the data will be right, it will just have added (unneeded) latency if you don't specify this.</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
==!Synchronizing==</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
The "copyts" flag might be useful to helping streams keep their input timestamps. Especially if you have multiple "-f dshow -i XXX -f dshow -i YYY" style inputs, the latter capture graph might get started up slightly after the former. If you desire to have more than "2 inputs, one audio, one video" to increase synconicity please request so.</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
==!Crossbar==</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
Some capture devices have "multiple inputs" for this type of capture device, you'll want to specify the "input pin" of video you want, and "input pin" of audio you want. See&nbsp;<a class="ext-link" href="http://ffmpeg.org/ffmpeg-devices.html#dshow" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../extlink.gif&quot;) left center no-repeat; padding-left: 15px;">​</span>FFmpeg dshow input device documentation</a></div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
==!Preview ==</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
You can preview it using ffplay, ex:</div>
<pre class="wiki" style="background: rgb(247, 247, 247); border-radius: 0.3em; border: 1px solid rgb(215, 215, 215); box-shadow: rgb(238, 238, 238) 0px 0px 1em; font-size: 13px; margin: 1em 1.75em; overflow: auto; padding: 0.25em;">ffplay -f dshow -video_size 1280x720 -rtbufsize 702000k -framerate 60 -i video="XX":audio="YY"
</pre>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
To "preview while you record" however you'd need to use the "SDL out" filter or output to a jpeg file and read that with some other application (tricky though as you'd have to avoid conflicting with ffmpeg re-writing the same file, recommend rename it first or something).</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
==TroubleShooting ==</div>
<blockquote style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
email&nbsp;<a class="mail-link" href="mailto:rogerdpack@gmail.com" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../envelope.png&quot;) left center no-repeat; padding-left: 16px;">​</span>rogerdpack@gmail.com</a></blockquote>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
If you only get "one packet" at times, you may need/want to add the "-vsync" flag.</div>
<h2 id="UsingDirectShowwithlibav" style="background-color: white; border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
Using DirectShow with libav*<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#UsingDirectShowwithlibav" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
You can use dshow input via the libavXXX libraries (i.e. directly into your own program) instead of calling out to ffmpeg.exe. See&nbsp;<a class="wiki" href="https://trac.ffmpeg.org/wiki/Using%20libav*" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Using libav*</a>&nbsp;for an intro to using libav. See also&nbsp;<a class="ext-link" href="http://ffmpeg.zeranoe.com/forum/viewtopic.php?f=15&amp;t=274&amp;p=902&amp;hilit=dictionary#p902" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../extlink.gif&quot;) left center no-repeat; padding-left: 15px;">​</span>http://ffmpeg.zeranoe.com/forum/viewtopic.php?f=15&amp;t=274&amp;p=902&amp;hilit=dictionary#p902</a></div>
<h2 id="Howtoprogrammaticallyenumeratedevices" style="background-color: white; border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
How to programmatically enumerate devices<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#Howtoprogrammaticallyenumeratedevices" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
FFmpeg does not provide a native way to do this yet, but you can lookup the devices yourself or just parse standard out from FFmpeg:&nbsp;<a class="ext-link" href="http://ffmpeg.zeranoe.com/forum/viewtopic.php?f=15&amp;t=651&amp;p=2963&amp;hilit=enumerate#p2963" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../extlink.gif&quot;) left center no-repeat; padding-left: 15px;">​</span>http://ffmpeg.zeranoe.com/forum/viewtopic.php?f=15&amp;t=651&amp;p=2963&amp;hilit=enumerate#p2963</a></div>
<h1 id="Related" style="background-color: white; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 19px; letter-spacing: -0.018em; margin: 0.15em 1em 0.5em -18px;">
Related<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#Related" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h1>
<h2 id="screencapture" style="background-color: white; border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
screen capture<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#screencapture" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
For details on capturing the screen (which sometimes can use a dshow device) see&nbsp;<a class="wiki" href="https://trac.ffmpeg.org/wiki/Capture/Desktop#Windows" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">Capture/Desktop#Windows</a>.</div>
<h2 id="AviSynthInput" style="background-color: white; border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
AviSynth Input<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#AviSynthInput" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
FFmpeg can also take arbitrary DirectShow input by creating an avisynth file (.avs file) that itself gets input from a graphedit file, which graphedit file exposes a pin of your capture source or any filter really, ex (<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">yo.avs</tt>) with this content:</div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">DirectShowSource("push2.GRF", fps=35, audio=False, framecount=1000000)</tt></div>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
By default dshow just creates a graph with a couple of source filters. So&nbsp;<a class="missing wiki" href="https://www.blogger.com/null" style="color: #999988;">AviSynth?</a>&nbsp;could be used to get input from more complex graphs (ping roger if you'd like anything more complex in the dshow source).</div>
<h2 id="Runningffmpeg.exewithoutopeningaconsolewindow" style="background-color: white; border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
Running&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">ffmpeg.exe</tt>&nbsp;without opening a console window<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#Runningffmpeg.exewithoutopeningaconsolewindow" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
If you want to run your ffmpeg "from a gui" without having it popup a console window which spits out all of ffmpeg's input, a few things that may help:</div>
<ul style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
<li>If you can start your program like&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">rubyw.exe</tt>&nbsp;or&nbsp;<tt style="background: rgb(250, 250, 250); border-radius: 0.25em; border: 1px solid rgb(238, 221, 204); color: #660000; padding: 0px 0.3em;">javaw.exe</tt>&nbsp;then all command line output (including child processes') is basically not attached to a console.</li>
<li>If your program has an option to run a child program "hidden" or the like, that might work. If you redirect stderr and stdout to something you receive, that might work (but might be tricky because you may need to read from both pipes in different threads, etc.)</li>
</ul>
<h1 id="ffdshowtryouts" style="background-color: white; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 19px; letter-spacing: -0.018em; margin: 0.15em 1em 0.5em -18px;">
ffdshow tryouts<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#ffdshowtryouts" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h1>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
<a class="ext-link" href="http://ffdshow-tryout.sourceforge.net/" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../extlink.gif&quot;) left center no-repeat; padding-left: 15px;">​</span>ffdshow tryouts</a>&nbsp;is a separate project that basically wraps FFmpeg's core source (libavcodec, etc.) and then presents them as filter wrappers that your normal Windows applications can use for decoding video, etc. It's not related to FFmpeg itself, per se, though uses it internally. see also&nbsp;<a class="missing wiki" href="https://www.blogger.com/null" style="color: #999988;">https://github.com/Nevcairiel/LAVFilters?</a></div>
<h1 id="Support" style="background-color: white; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 19px; letter-spacing: -0.018em; margin: 0.15em 1em 0.5em -18px;">
Support<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#Support" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h1>
<div style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
You can ask questions/comments about&nbsp;<a class="wiki" href="https://trac.ffmpeg.org/wiki/DirectShow" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;">DirectShow</a>&nbsp;on the&nbsp;<a class="ext-link" href="http://ffmpeg.zeranoe.com/forum/" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../extlink.gif&quot;) left center no-repeat; padding-left: 15px;">​</span>Zeranoe FFmpeg Forum</a>. or email roger.</div>
<h2 id="KnownBugsFeatureRequests" style="background-color: white; border-bottom: 1px solid rgb(221, 221, 221); box-shadow: rgb(242, 242, 242) 0.1em 0.4em 0.7em 0px; break-after: avoid; font-family: Arial, Verdana, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 16px; letter-spacing: -0.018em; margin-left: -18px; padding: 0.2em 0.3em 0.1em;">
Known Bugs/Feature Requests<a class="anchor" href="https://trac.ffmpeg.org/wiki/DirectShow#KnownBugsFeatureRequests" style="border: none; color: #d7d7d7; font-size: 0.8em; text-decoration-line: none; vertical-align: text-top; visibility: hidden;" title="Link to this section"></a></h2>
<div class="wikipage" style="background-color: #fffff9; border: 1pt dotted; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px; margin: 1em; padding-left: 18px;">
Send a message to&nbsp;<a class="mail-link" href="mailto:rogerdpack@gmail.com" style="border-bottom: 1px dotted rgb(187, 187, 187); color: #bb0000; text-decoration-line: none;"><span class="icon" style="background: url(&quot;../envelope.png&quot;) left center no-repeat; padding-left: 16px;">​</span>rogerdpack@gmail.com</a>&nbsp;if you want to discuss these issues.</div>
<ul style="background-color: white; font-family: Verdana, Arial, &quot;Bitstream Vera Sans&quot;, Helvetica, sans-serif; font-size: 13px;">
<li>Do you have a feature request? Anything you want added? digital capture card support added? analog tv tuner support added? email me (see above). Want any of the below fixed? email me...</li>
<li>currently there is no ability to "push back" against upstream sources if ffmpeg is unable to encode fast enough, this might be nice to have in certain circumstances, instead of dropping it when the rtbuffer is full.</li>
<li>currently no ability to select "i420" from various yuv options [screen capture recorder] meh</li>
<li>could use an option "trust video timestamps" today it just uses wall clock time...</li>
<li>cannot take more than 2 inputs [today] per invocation. this can be arranged, please ask if it is a desired feature</li>
<li>no device enumeration API as of yet (for libav users). At least do the name!</li>
<li>my large list</li>
<li>libav "input" to a directshow filter...could use my recycled screen-capture-recorder filter, woot LOL.</li>
<li>3D audio support'ish (non dshow but mentioning it here)</li>
<li>passthrough so it can use locally installed dshow codecs on windows</li>
<li>echo cancelling support (non dshow but mentioning it here)</li>
</ul>
<div>
<div class="note" style="box-sizing: border-box; color: #333333; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 17px; padding-top: 10px; position: relative;">
<div class="post" style="box-sizing: border-box; margin: 0px auto; padding-bottom: 40px; padding-top: 20px; width: 620px;">
<div class="article" style="box-sizing: border-box;">
<div class="show-content" data-note-content="" style="box-sizing: border-box; color: #2f2f2f; font-size: 16px; line-height: 1.7; word-break: break-word !important;">
<div style="box-sizing: border-box; margin-bottom: 25px; word-break: break-word !important;">
<br /></div>
<div style="box-sizing: border-box; margin-bottom: 25px; word-break: break-word !important;">
</div>
<h3 style="box-sizing: border-box; font-family: inherit; font-size: 22px; line-height: 1.7; margin: 0px 0px 15px; text-rendering: optimizeLegibility;">
二、FFmpeg推流</h3>
<div>
<pre class="hljs cpp" style="background: rgb(246, 246, 246); border-radius: 0px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #657b83; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 20px; overflow: auto; padding: 15px; text-size-adjust: none; word-break: break-word !important; word-wrap: normal;"><code class="cpp" style="background-color: transparent; border-radius: 0px; border: none; box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; padding: 0px;">ffmpeg -re -i /Users/xu/Desktop/bangbangbang.mp4 -vcodec libx264 -acodec aac -f flv rtmp:<span class="hljs-comment" style="box-sizing: border-box; color: #93a1a1;">//localhost:1935/rtmplive/home</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<h3 style="background-color: white; box-sizing: border-box; color: #2f2f2f; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 22px; line-height: 1.7; margin: 0px 0px 15px; text-rendering: optimizeLegibility;">
三、用ffmpeg推流桌面</h3>
<div>
<pre class="hljs cpp" style="background: rgb(246, 246, 246); border-radius: 0px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #657b83; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 20px; overflow: auto; padding: 15px; text-size-adjust: none; word-break: break-word !important; word-wrap: normal;"><code class="cpp" style="background-color: transparent; border-radius: 0px; border: none; box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; padding: 0px;">ffmpeg -f avfoundation -i <span class="hljs-string" style="box-sizing: border-box; color: #2aa198;">"1"</span> -vcodec libx264 -preset ultrafast -acodec libfaac -f flv rtmp:<span class="hljs-comment" style="box-sizing: border-box; color: #93a1a1;">//localhost:1935/rtmplive/home</span></code></pre>
</div>
